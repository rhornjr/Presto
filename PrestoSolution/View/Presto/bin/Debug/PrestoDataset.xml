<?xml version="1.0" standalone="yes"?>
<PrestoDataset xmlns="http://tempuri.org/PrestoDataset.xsd">
  <TaskGroup>
    <TaskGroupId>1</TaskGroupId>
    <TaskGroupName>Hello World</TaskGroupName>
  </TaskGroup>
  <TaskItem>
    <TaskItemId>1</TaskItemId>
    <FailureCausesAllStop>1</FailureCausesAllStop>
    <Description>Set value 1 in config file</Description>
    <TaskGroupId>1</TaskGroupId>
    <TaskTypeId>2</TaskTypeId>
    <Sequence>2</Sequence>
  </TaskItem>
  <TaskItem>
    <TaskItemId>2</TaskItemId>
    <FailureCausesAllStop>1</FailureCausesAllStop>
    <Description>Create Installation Folder</Description>
    <TaskGroupId>1</TaskGroupId>
    <TaskTypeId>1</TaskTypeId>
    <Sequence>0</Sequence>
  </TaskItem>
  <TaskItem>
    <TaskItemId>3</TaskItemId>
    <FailureCausesAllStop>1</FailureCausesAllStop>
    <Description>Copy Production Release Files</Description>
    <TaskGroupId>1</TaskGroupId>
    <TaskTypeId>3</TaskTypeId>
    <Sequence>1</Sequence>
  </TaskItem>
  <TaskItem>
    <TaskItemId>4</TaskItemId>
    <FailureCausesAllStop>1</FailureCausesAllStop>
    <Description>Set value 2 in config file</Description>
    <TaskGroupId>1</TaskGroupId>
    <TaskTypeId>2</TaskTypeId>
    <Sequence>3</Sequence>
  </TaskItem>
  <TaskItem>
    <TaskItemId>5</TaskItemId>
    <FailureCausesAllStop>1</FailureCausesAllStop>
    <Description>Create Hello World Service</Description>
    <TaskGroupId>1</TaskGroupId>
    <TaskTypeId>1</TaskTypeId>
    <Sequence>4</Sequence>
  </TaskItem>
  <TaskCopyFile>
    <TaskItemId>3</TaskItemId>
    <SourcePath>$(productionReleaseFolder)</SourcePath>
    <SourceFileName>*</SourceFileName>
    <DestinationPath>$(helloWorldInstallationFolder)</DestinationPath>
  </TaskCopyFile>
  <TaskType>
    <TaskTypeId>1</TaskTypeId>
    <Description>TaskDosCommand</Description>
  </TaskType>
  <TaskType>
    <TaskTypeId>2</TaskTypeId>
    <Description>TaskXmlModify</Description>
  </TaskType>
  <TaskType>
    <TaskTypeId>3</TaskTypeId>
    <Description>TaskCopyFile</Description>
  </TaskType>
  <TaskType>
    <TaskTypeId>4</TaskTypeId>
    <Description>TaskMsi</Description>
  </TaskType>
  <TaskDosCommand>
    <TaskItemId>2</TaskItemId>
    <DosExecutable>cmd</DosExecutable>
    <Parameters>/c mkdir "$(helloWorldInstallationFolder)"</Parameters>
  </TaskDosCommand>
  <TaskDosCommand>
    <TaskItemId>5</TaskItemId>
    <DosExecutable>cmd</DosExecutable>
    <Parameters>/c sc create "$(serviceName)" binPath= "$(helloWorldInstallationFolder)\HelloWorldWindowsService.exe"</Parameters>
  </TaskDosCommand>
  <TaskXmlModify>
    <TaskItemId>1</TaskItemId>
    <XmlPathAndFileName>$(helloWorldInstallationFolder)\HelloWorldWindowsService.exe.config</XmlPathAndFileName>
    <NodeToChange>appSettings/add</NodeToChange>
    <AttributeKey>key</AttributeKey>
    <AttributeKeyValue>SampleKey1</AttributeKeyValue>
    <AttributeToChange>value</AttributeToChange>
    <AttributeToChangeValue>SampleValue1 - New</AttributeToChangeValue>
  </TaskXmlModify>
  <TaskXmlModify>
    <TaskItemId>4</TaskItemId>
    <XmlPathAndFileName>$(helloWorldInstallationFolder)\HelloWorldWindowsService.exe.config</XmlPathAndFileName>
    <NodeToChange>appSettings/add</NodeToChange>
    <AttributeKey>key</AttributeKey>
    <AttributeKeyValue>SampleKey2</AttributeKeyValue>
    <AttributeToChange>value</AttributeToChange>
    <AttributeToChangeValue>SampleValue2 - New</AttributeToChangeValue>
  </TaskXmlModify>
  <CustomVariable>
    <TaskGroupId>1</TaskGroupId>
    <VariableKey>serviceName</VariableKey>
    <VariableValue>Hello World</VariableValue>
    <CustomVariableId>1</CustomVariableId>
  </CustomVariable>
  <CustomVariable>
    <TaskGroupId>1</TaskGroupId>
    <VariableKey>helloWorldInstallationFolder</VariableKey>
    <VariableValue>C:\Temp</VariableValue>
    <CustomVariableId>2</CustomVariableId>
  </CustomVariable>
  <CustomVariable>
    <TaskGroupId>1</TaskGroupId>
    <VariableKey>productionReleaseFolder</VariableKey>
    <VariableValue>..\..\HelloWorldService</VariableValue>
    <CustomVariableId>3</CustomVariableId>
  </CustomVariable>
</PrestoDataset>